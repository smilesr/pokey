<!DOCTYPE html>
<html lang="en">
  <head>
    <title> Pokemon Table </title>
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <style>
    .jumbotron {
      text-align: center;
    }
    </style>


  </head>
  <body>
    <div class="container-fluid">
      <div class="jumbotron"> 
        <h1>POKEMON GENERATOR</h1>
              <button type="button" class="btn btn-success">Pick a Pokemon</button>
      </div>

      <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th>Name</th>
        <th>Base Experience</th>
        <th>Abilities</th>
        <th>Moves</th>
    </thead>
    <tbody class="pokemon0">
<!--       <tr class="pokemon0">
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr class="pokemon1">
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr class="pokemon2">
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>  
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>   -->       
    </tbody>
  </table>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
    const butt = document.querySelector('button');
    const tableContainer = document.querySelector('tbody');
    console.log('global')


    function getPokemon(){
      console.log('run getPokemon')
      let randomNumber = getRandom();
      let httpRequest = new XMLHttpRequest();
      httpRequest.onreadystatechange = function()
       {
        console.log("readystate: " + this.readyState)
        if (this.readyState == 4 && this.status == 200)
          {
            let response = JSON.parse(this.responseText);
            let abilitiesList = getAbilities(response);
            
            let movesList = getMoves(response);
            
            let pokemonName = response.name;
            let experience = response.base_experience;
        
            let movements = response.moves
            // debugger;
            addRow();
            insertPokemonName(pokemonName);
            insertExperience(experience);
            insertAbilities(abilitiesList);
            truncatedMovesList = movesList.slice(0,4);
            insertMoves(truncatedMovesList);
            console.log('bing bong')
          
          }
        }
        httpRequest.open("GET","http://pokeapi.co/api/v2/pokemon/" + randomNumber, true);
        httpRequest.send();
      
    }
    function addRow(){
      let row = tableContainer.insertRow(-1);
      for (let i = 0; i<4; i++){
        row.insertCell(-1);
      }
      
      // let textnode = document.createTextNode("");
      // tableContainer.appendChild(textnode);
    }
    function checkWhichRow(){

    }
    // function insertPokeInfo(attributeObject){
    //   let target = document.querySelector("tbody");
    //   let targetChildren = target.children;


    // }
    function insertPokemonName(name){
      let target = tableContainer.lastChild;
      target.children[0].innerHTML = name;
    }
       function insertExperience(experience){
       let target = tableContainer.lastChild;
      target.children[1].innerHTML = experience;
    }
        function insertAbilities(abilitiesList){
        let target = tableContainer.lastChild;
      target.children[2].innerHTML = abilitiesList;
    }
        function insertMoves(movesList){
      let target = tableContainer.lastChild;
      target.children[3].innerHTML = movesList;
    } 
    function getAbilities(obj){
      console.log('run abil')
      let list = [];
      let aList = obj.abilities;
      for (let i in aList){
        list.push(aList[i].ability.name);
      }

      return list;
    }
    function getMoves(obj){
      console.log('run mov')
      let list = [];
      let mList = obj.moves;
      for (let i in mList){
        list.push(mList[i].move.name);
      }

      // for (let i in obj){

      //    list.push(abilities[i].move.name);

      // }

      return list;
    }
// response.abilities["0"].ability.name
// response.moves["0"].move.name
    // function findMoves(movesObject){
    //   console.log('run moves')
    //   let movesList = [];
    //   movesObject.
    // }
    function getRandom(){
      console.log('run getRandom')
      let min = Math.ceil(1);
      let max = Math.floor(711);
      return Math.floor(Math.random() * (max - min)) + min;
    }
        butt.addEventListener('click', getPokemon);
    </script>
  </body>
</html>